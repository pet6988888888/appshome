<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Web App Dashboard</title>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');

        /* Custom Styles from the Integration Guide */
        body {
            font-family: 'Poppins', sans-serif;
            min-height: 100vh;
            background-color: #1a202c; /* Dark background default */
            color: #e2e8f0; /* Light text default */
            margin: 0;
            overflow-x: hidden; 
            transition: background-color 0.3s, color 0.3s; /* Smooth theme transition */
        }

        /* LIGHT THEME OVERRIDES */
        .light-theme {
            background-color: #f7fafc; /* Very light background */
            color: #1a202c; /* Dark text */
        }
        .light-theme .login-card {
            background-color: rgba(255, 255, 255, 0.9); /* White frosted glass */
            border: 1px solid rgba(226, 232, 240, 0.5); 
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .light-theme #login-container {
            background-color: rgba(247, 250, 252, 0.95);
        }
        .light-theme .bg-gray-800 { 
            background-color: #ffffff; /* White card background */
            border: 1px solid #e2e8f0; 
        }
        /* Dashboard Text and Borders */
        .light-theme .text-gray-400 { color: #4a5568; }
        .light-theme .bg-gray-700, .light-theme .text-gray-200 { 
            background-color: #e2e8f0; 
            color: #2d3748; 
        }
        .light-theme .border-gray-700 { border-color: #e2e8f0; }
        .light-theme .text-gray-300 { color: #2d3748; }
        .light-theme .text-gray-500 { color: #a0aec0; }
        .light-theme .login-card input {
            background-color: #ffffff;
            border-color: #e2e8f0;
            color: #1a202c;
        }

        /* Animated Gradient Background */
        .gradient-bg {
            position: fixed; /* Fixed position */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #4f46e5, #8b5cf6, #ec4899); 
            background-size: 300% 300%;
            animation: gradient-animation 10s ease infinite;
            z-index: -2; /* Below everything */
            opacity: 0.3; 
        }

        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Login Card Styling (Frosted Glass Effect) */
        .login-card {
            background-color: rgba(30, 41, 59, 0.9); 
            border: 1px solid rgba(71, 85, 105, 0.5); 
            backdrop-filter: blur(8px); 
        }

        /* Full-screen Login Overlay */
        #login-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200; 
            background-color: rgba(26, 32, 44, 0.95); 
            transition: opacity 0.5s ease-in-out;
        }

        /* Message Box Styling */
        .message-box {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            padding: 1rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
            transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out;
            transform: translateY(-20px);
            z-index: 300; 
        }
        .message-box.show {
            transform: translateY(0);
            opacity: 1;
        }
        .message-box.hidden {
            opacity: 0;
            pointer-events: none; 
        }

        /* Spinner animation */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Style for the dashboard item links */
        .app-link {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .app-link:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(79, 70, 229, 0.4);
        }

        /* Grayscale effect for inactive apps */
        .grayscale-inactive {
            filter: grayscale(100%) brightness(70%);
            opacity: 0.7;
        }

        /* --- Custom CSS for 3:2 Aspect Ratio Thumbnail (600x400) --- */
        .aspect-3-2 {
            position: relative;
            width: 100%;
            /* 400 / 600 = 0.6666... */
            padding-bottom: 66.66%; 
            height: 0;
            overflow: hidden;
        }
        .aspect-3-2 > img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        /* ---------------------------------------------------------------- */

        /* Modal Styles for Video Popup */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: none; /* Hidden by default */
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background: #1a202c;
            max-width: 90vw;
            max-height: 90vh;
            width: 600px; /* Default width */
            border-radius: 1rem;
            /* Updated shadow to a darker, subtler purple glow */
            box-shadow: 0 0 40px rgba(124, 58, 237, 0.4); 
            position: relative;
        }
        .modal-body {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio for video */
            height: 0;
            overflow: hidden;
            border-radius: 0 0 1rem 1rem;
        }
        /* Style the video element for full modal coverage */
        .modal-body video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* Ensure video player styling looks good */
            background-color: black; 
        }
    </style>
</head>

<!-- Body modification to disable right-click menu and listen for activity -->
<body oncontextmenu="return false;" 
      onmousemove="resetTimer()" 
      onkeypress="resetTimer()" 
      onclick="resetTimer()">
    
    <!-- Background Gradient Layer -->
    <div class="gradient-bg"></div>

    <!-- -------------------------------------------------------- -->
    <!-- LOGIN OVERLAY (STEP 1: Protected Layer) -->
    <!-- -------------------------------------------------------- -->
    <div id="login-container">
        <div class="login-card p-10 rounded-2xl shadow-2xl w-full max-w-md text-center">
            <h2 class="text-3xl font-bold mb-8 text-white">Secure Access Required</h2>
            
            <div class="mb-5 text-left">
                <label for="username" class="block text-sm font-medium text-gray-300 mb-2">Username</label>
                <input type="text" id="username" class="w-full px-5 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200" placeholder="Enter username">
            </div>
            
            <div class="mb-7 text-left">
                <label for="password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                <input type="password" id="password" class="w-full px-5 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 transition duration-200" placeholder="Enter password">
            </div>
            
            <button onclick="attemptLogin()" id="login-button" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg font-semibold text-lg hover:from-indigo-700 hover:to-purple-700 transition duration-300 shadow-lg flex items-center justify-center">
                <span id="login-button-text">Access Dashboard</span>
                <div id="login-spinner" class="spinner ml-3 hidden"></div>
            </button>
        </div>
    </div>

    <!-- -------------------------------------------------------- -->
    <!-- PROTECTED CONTENT (STEP 2: The Dashboard) -->
    <!-- -------------------------------------------------------- -->
    <!-- This container holds all your page content and is hidden until login -->
    <div id="protected-content" class="p-4 sm:p-8 md:p-12 transition-opacity duration-700 opacity-0">

        <!-- Dashboard Header -->
        <header class="max-w-7xl mx-auto mb-12 flex justify-between items-center pt-8 pb-4 border-b border-gray-700">
            <h1 class="text-4xl font-extrabold text-indigo-400 tracking-tight">
                App Dashboard
            </h1>
            <div class="flex items-center space-x-4">
                <!-- Theme Toggle Button -->
                <button id="theme-toggle" onclick="toggleTheme()" class="p-2 rounded-full bg-gray-700 hover:bg-gray-600 transition duration-200">
                    <!-- SVG Icon is set dynamically by JavaScript -->
                </button>
                <button onclick="logout('user')" class="bg-gray-700 text-gray-200 py-2 px-4 rounded-lg font-medium hover:bg-gray-600 transition duration-200 text-sm">
                    Log Out
                </button>
            </div>
        </header>

        <!-- Application Grid -->
        <main class="max-w-7xl mx-auto">
            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-300 border-l-4 border-purple-500 pl-3 mb-4 sm:mb-0">Your Available Apps</h2>
                
                <!-- Filter Dropdown Container -->
                <div class="flex items-center space-x-3">
                    <label for="tag-filter" class="text-gray-400 text-sm font-medium hidden sm:block">Filter by Category:</label>
                    <select id="tag-filter" onchange="filterApps()" class="px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm focus:ring-purple-500 focus:border-purple-500 transition duration-200">
                        <!-- Options will be populated by JS -->
                    </select>
                </div>
            </div>
            
            <!-- This div will be populated dynamically by JavaScript -->
            <div id="app-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- App cards rendered here -->
            </div>
        </main>
        
        <footer class="max-w-7xl mx-auto mt-20 text-center text-gray-500 text-sm">
            <p>&copy; 2025 Secure Dashboard. All rights reserved.</p>
        </footer>

    </div>

    <!-- Custom Message Box for Login Attempts -->
    <div id="message-box" class="message-box hidden"></div>

    <!-- -------------------------------------------------------- -->
    <!-- VIDEO MODAL STRUCTURE -->
    <!-- -------------------------------------------------------- -->
    <div id="video-modal-overlay" class="modal-overlay" onclick="closeModal()">
        <div id="video-modal-content" class="modal-content" onclick="event.stopPropagation()">
            <div class="p-4 flex justify-between items-center border-b border-gray-700">
                <h3 id="modal-title" class="text-xl font-semibold text-white">How-To Guide</h3>
                <button onclick="closeModal()" class="text-gray-400 hover:text-white transition duration-200 text-2xl leading-none">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Using HTML5 video for greater security compliance and reliability -->
                <video id="video-element" controls preload="auto"></video>
            </div>
        </div>
    </div>

    <script>
        // --- TIMEOUT CONFIGURATION ---
        const INACTIVITY_TIMEOUT_MS = 600000; // 3 minutes in milliseconds
        let timeoutTimer;
        let isLoggedIn = false;

        // --- DATA CONSTANTS ---
        const GENERIC_MP4_URL = "https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-576p.mp4";

        const appData = [
            {
                name: "Social Post Studio",
                description: "Create social post quickly and easily.",
                href: "http://social.homeworkoutfactory.com/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/socialpostbuilder.mp4", 
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/1.png",
                colorClass: "purple",
                isActive: true,
                tags: ["Graphic Design", "AI"], 
            },
            {
                name: "Meal Plan Builder",
                description: "Build effective meal plans fast, with recipes your customers will love.",
                href: "https://pet6988888888.github.io/mealplanner/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/05.12.2025_14.22.42_REC.mp4", 
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/3.png",
                colorClass: "green",
                isActive: true,
                tags: ["Nutrition", "Product Creation"],
            },
            {
                name: "Carousel Creator", 
                description: "Create viral instagram carousel images quickly",
                href: "https://insta.homeworkoutfactory.com/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/05.12.2025_13.11.45_REC.mp4", 
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/2.png",
                colorClass: "yellow",
                isActive: true, // This triggers the (DEACTIVATED) suffix
                tags: ["Graphic Design", "AI"],
            },
            {
                name: "Home Workout Builder",
                description: "Create powerful home workout programs and challenges",
                href: "https://pet6988888888.github.io/workoutbuilder/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/workout.mp4",  
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/Untitled%20design%20(11).png",
                colorClass: "blue",
                isActive: true,
                tags: ["Workouts", "Product Creation"],
            },
            {
                name: "Cover Creator",
                description: "Create professional looking covers fast",
                href: "https://pet6988888888.github.io/cover/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/cover.mp4",  
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/Untitled%20design%20(10).png",
                colorClass: "orange",
                isActive: true,
                tags: ["Graphic Design"],
            },
            {
                name: "Cookbook Creator",
                description: "Your ultimate tool for creating jaw-dropping cookbooks, quickly!",
                href: "https://pet6988888888.github.io/cookbook/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/cookbook.mp4",  
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/Untitled%20design%20(9).png",
                colorClass: "green",
                isActive: true,
                tags: ["Nutrition", "Product Creation"],
            },
            {
                name: "Quiz Builder",
                description: "Build quizzes that drive engagement, trust, and sales",
                href: "https://pet6988888888.github.io/qabuilder/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/quiz.mp4",  
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/Untitled%20design%20(12).png",
                colorClass: "blue",
                isActive: true,
                tags: ["Marketing", "Product Creation"],
            },
            {
                name: "Viral Content Creator",
                description: "Create viral-ready posts in seconds.",
                href: "https://viral.homeworkoutfactory.com/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/viral.mp4",  
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/Untitled%20design%20(13).png",
                colorClass: "purple",
                isActive: true,
                tags: ["Marketing", "AI"],
            },
            {
                name: "AI Client Plan Creator",
                description: "Create custom workout and eating plans for your customres fast",
                href: "https://ptpro.homeworkoutfactory.com/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/aiprogramcreator.mp4",  
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/Untitled%20design%20(15).png",
                colorClass: "teal",
                isActive: true,
                tags: ["Product Creation", "Nutrition", "Workouts", "AI"],
            },
            {
                name: "Workout App Builder",
                description: "Create full following along workout apps",
                href: "https://pet6988888888.github.io/appbuilder/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/appbuilder.mp4",  
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/Untitled%20design%20(16).png",
                colorClass: "purple",
                isActive: true,
                tags: ["Product Creation", "Workouts"],
            },
                        {
                name: "Lead & Traffic Generation Apps",
                description: "Fun apps to help you drive traffic and generate leads",
                href: "https://apps.homeworkoutfactory.com/leadgen/",
                videoUrl: "https://homeworkoutfactory.com/wp-content/uploads/2025/12/ledgen.mp4",  
                imgSrc: "https://raw.githubusercontent.com/pet6988888888/images/refs/heads/main/Untitled%20design%20(17).png",
                colorClass: "purple",
                isActive: true,
                tags: ["Product Creation", "Workouts"],
            },
        ];

        // --- GLOBAL UI ELEMENTS ---
        const VALID_USERNAME = '@carvell';
        const VALID_PASSWORD = 'Carvell1423'; 
        const body = document.body;
        const loginContainer = document.getElementById('login-container');
        const protectedContent = document.getElementById('protected-content');
        const messageBox = document.getElementById('message-box');
        const loginButton = document.getElementById('login-button');
        const loginButtonText = document.getElementById('login-button-text');
        const loginSpinner = document.getElementById('login-spinner');
        const appGrid = document.getElementById('app-grid');
        const modalOverlay = document.getElementById('video-modal-overlay');
        const videoElement = document.getElementById('video-element');
        const modalTitle = document.getElementById('modal-title');
        const tagFilter = document.getElementById('tag-filter');
        const themeToggle = document.getElementById('theme-toggle');


        // --- THEME MANAGEMENT ---

        /**
         * Applies the specified theme (light or dark) to the body and saves preference.
         * Also updates the toggle button icon.
         */
        function applyTheme(theme) {
            if (theme === 'light') {
                body.classList.add('light-theme');
                localStorage.setItem('theme', 'light');
                // Sun icon for light mode (suggesting switching to dark)
                themeToggle.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-500" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M10 2a1 1 0 011 1v1a1 1 0 01-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 14.95a1 1 0 101.414-1.414l-.707-.707a1 1 0 00-1.414 1.414l.707.707zm1.414-9.9a1 1 0 10-1.414 1.414l.707.707a1 1 0 101.414-1.414l-.707-.707z" />
                    </svg>
                `;
            } else {
                body.classList.remove('light-theme');
                localStorage.setItem('theme', 'dark');
                // Moon icon for dark mode (suggesting switching to light)
                themeToggle.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-400" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M17.293 13.987a1 1 0 01-.62-1.854 8 8 0 00-10.748-10.748 1 1 0 01-1.854-.62A10.007 10.007 0 003 10c0 5.514 4.486 10 10 10a10.007 10.007 0 007-2.712 1 1 0 01-.707-1.301z" />
                    </svg>
                `;
            }
        }

        /**
         * Toggles the current theme between dark and light.
         */
        function toggleTheme() {
            // Read current theme from localStorage, default to dark if not set
            const currentTheme = localStorage.getItem('theme') || 'dark';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(newTheme);
        }

        /**
         * Initializes the state and renders app cards on page load.
         */
        window.onload = function() {
            // Check for saved theme preference or default to DARK if none is saved (NEW LOGIC)
            const savedTheme = localStorage.getItem('theme') || 'dark';
            applyTheme(savedTheme);

            protectedContent.classList.remove('opacity-100');
            protectedContent.classList.add('opacity-0');
            renderAppCards();
            populateTags(); 
        };

        /**
         * Clears the current timeout and sets a new one.
         * This function is attached to mousemove, keypress, and click events on the <body>.
         */
        function resetTimer() {
            if (isLoggedIn) {
                clearTimeout(timeoutTimer);
                // Set the timer to call the logout function after the inactivity period
                timeoutTimer = setTimeout(() => logout('timeout'), INACTIVITY_TIMEOUT_MS);
            }
        }

        /**
         * Shows a temporary message to the user.
         */
        function showMessage(message, type) {
            messageBox.textContent = message;
            messageBox.classList.remove('bg-red-700', 'bg-green-700', 'border-red-400', 'border-green-400', 'text-white');
            messageBox.classList.add('show'); 

            if (type === 'success') {
                messageBox.classList.add('bg-green-700', 'border-green-400', 'text-white');
            } else {
                messageBox.classList.add('bg-red-700', 'border-red-400', 'text-white');
            }
            messageBox.classList.remove('hidden');

            setTimeout(() => {
                messageBox.classList.remove('show');
                messageBox.classList.add('hidden'); 
            }, 3000);
        }

        /**
         * Handles the login attempt.
         */
        function attemptLogin() {
            const usernameInput = document.getElementById('username').value;
            const passwordInput = document.getElementById('password').value;

            // Show checking animation
            loginButtonText.textContent = 'Checking...';
            loginSpinner.classList.remove('hidden');
            loginButton.disabled = true; 

            setTimeout(() => {
                loginButtonText.textContent = 'Access Dashboard';
                loginSpinner.classList.add('hidden');
                loginButton.disabled = false;

                if (usernameInput === VALID_USERNAME && passwordInput === VALID_PASSWORD) {
                    // Successful Login: Hide overlay and reveal page content
                    isLoggedIn = true;
                    resetTimer(); // Start the inactivity timer
                    loginContainer.style.opacity = '0';
                    
                    setTimeout(() => {
                        loginContainer.style.display = 'none'; // Completely remove overlay
                        protectedContent.classList.remove('opacity-0');
                        protectedContent.classList.add('opacity-100');
                        showMessage('Access granted! Welcome to the dashboard.', 'success');
                    }, 500);
                    
                } else {
                    // Failed Login
                    showMessage('Invalid credentials. Please try again.', 'error');
                }
            }, 1500); // Simulated network delay
        }

        /**
         * Allows logging out and returning to the login screen.
         * @param {string} reason The reason for logging out ('user' for manual, 'timeout' for inactivity).
         */
        function logout(reason) {
            // Stop the timer, user is no longer logged in
            clearTimeout(timeoutTimer);
            isLoggedIn = false; 

            protectedContent.classList.remove('opacity-100');
            protectedContent.classList.add('opacity-0');
            
            setTimeout(() => {
                loginContainer.style.display = 'flex';
                loginContainer.style.opacity = '1';
                
                // Clear inputs
                document.getElementById('username').value = ''; 
                document.getElementById('password').value = '';
                
                if (reason === 'timeout') {
                    showMessage('Session expired due to 3 minutes of inactivity.', 'error');
                } else {
                    showMessage('Dashboard re-protected. Login required.', 'success');
                }
            }, 500);
        }

        /**
         * Extracts unique tags from appData and populates the filter dropdown.
         */
        function populateTags() {
            const allTags = new Set(["All Categories"]); // Start with default option
            
            appData.forEach(app => {
                if (app.tags) {
                    app.tags.forEach(tag => allTags.add(tag));
                }
            });

            tagFilter.innerHTML = ''; // Clear existing options
            
            allTags.forEach(tag => {
                const option = document.createElement('option');
                option.value = tag;
                option.textContent = tag;
                tagFilter.appendChild(option);
            });
        }

        /**
         * Filters the app cards based on the selected tag in the dropdown.
         */
        function filterApps() {
            const selectedTag = tagFilter.value;

            // Filter the data based on the selected tag
            const filteredData = appData.filter(app => {
                if (selectedTag === "All Categories") {
                    return true; // Show all apps
                }
                // Check if the app's tags array includes the selected tag
                return app.tags && app.tags.includes(selectedTag);
            });

            // Re-render the grid with the filtered data
            renderAppCards(filteredData);
        }
        
        /**
         * Dynamically generates the app cards based on the provided array.
         * @param {Array<Object>} appsToRender The array of apps to display. Defaults to all apps.
         */
        function renderAppCards(appsToRender = appData) {
            let html = '';
            appGrid.innerHTML = ''; // Clear the grid first

            if (appsToRender.length === 0 && tagFilter.value !== "All Categories") {
                 appGrid.innerHTML = `<div class="text-gray-400 text-lg col-span-full py-10 text-center">No apps found matching the category "${tagFilter.value}".</div>`;
                 return;
            }
            
            appsToRender.forEach((app, index) => {
                const statusClass = app.isActive ? '' : 'grayscale-inactive';
                const buttonDisabled = app.isActive ? '' : 'disabled';
                const shadowClass = `hover:shadow-${app.colorClass}-500/50`;
                const titleColor = `text-${app.colorClass}-300`;
                const accessBg = app.isActive ? `bg-${app.colorClass}-600 hover:bg-${app.colorClass}-700` : 'bg-gray-500 cursor-not-allowed';
                const howToBg = app.isActive ? `bg-gray-700 hover:bg-gray-600` : 'bg-gray-500 cursor-not-allowed';

                // NEW LOGIC: Determine the suffix for the title
                const titleSuffix = app.isActive ? '' : ' (DEACTIVATED)';

                html += `
                    <div class="app-link bg-gray-800 rounded-xl shadow-xl overflow-hidden ${shadowClass} transition duration-300 block ${statusClass}">
                        <div class="aspect-3-2 rounded-t-xl overflow-hidden">
                            <img src="${app.imgSrc}" 
                                alt="${app.name} App Thumbnail" 
                                onerror="this.onerror=null; this.src='https://placehold.co/600x400/374151/ffffff?text=${app.name.replace(/ /g, '+')}';">
                        </div>
                        <div class="p-5">
                            <!-- UPDATED: Added titleSuffix here -->
                            <h3 class="text-xl font-bold ${titleColor} mb-1">${app.name}${titleSuffix}</h3>
                            <p class="text-gray-400 text-sm mb-2">${app.description}</p>
                            <!-- REMOVED TAGS DISPLAY from here -->
                            
                            <div class="flex space-x-3 mt-4">
                                <a ${buttonDisabled} href="${app.isActive ? app.href : 'javascript:void(0)'}" target="_blank" class="flex-1 text-center text-white py-2 px-3 rounded-lg font-semibold text-sm transition duration-200 ${accessBg} ${buttonDisabled ? 'opacity-50' : ''}">
                                    ACCESS
                                </a>
                                <button ${buttonDisabled} onclick="${app.isActive ? `showVideoModal('${app.name}', '${app.videoUrl}')` : `showMessage('App is deactivated.', 'error')`}" class="text-white py-2 px-3 rounded-lg font-semibold text-sm transition duration-200 ${howToBg} ${buttonDisabled ? 'opacity-50' : ''}">
                                    HOW TO
                                </sbutton>
                            </div>
                        </div>
                    </div>
                `;
            });
            appGrid.innerHTML = html;
        }

        /**
         * Shows the video modal using the standard HTML5 <video> element.
         * @param {string} appName The name of the app.
         * @param {string} videoUrl The URL for the video source (MP4).
         */
        function showVideoModal(appName, videoUrl) {
            modalTitle.textContent = `How-To Guide: ${appName}`;
            
            // Set the video source, load, and play
            videoElement.src = videoUrl; 
            videoElement.load();
            videoElement.play();
            
            modalOverlay.style.display = 'flex';
        }

        /**
         * Closes the video modal and stops the video playback.
         */
        function closeModal() {
            videoElement.pause(); // Pause the video
            videoElement.currentTime = 0; // Reset video to the start
            videoElement.src = ''; // Clear the source to stop loading/buffering
            modalOverlay.style.display = 'none';
        }


        // --- SOURCE CODE PROTECTION (Disabling Keyboard Shortcuts) ---
        document.addEventListener('keydown', function (e) {
            // F12, Ctrl+Shift+I, Ctrl+U, Ctrl+Shift+J
            if (e.key === 'F12' || e.keyCode === 123 || 
                (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) || 
                (e.ctrlKey && e.key === 'u')) 
            {
                e.preventDefault();
                showMessage('Access to developer tools blocked for this demo.', 'error');
            }
        });
    </script>
</body>
</html>
